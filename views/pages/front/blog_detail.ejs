<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title><%= blog.titre %></title>
        <meta name="description" content="<%= blog.preview %>" />
        <meta name="keywords" content="<%= keywords %>, spirit of freedom kennel, american bully, élevage canin gard, blog élevage, codognan, chiots ABKC FBKC" />
        <meta name="author" content="<%= userInfo.kennel_name || 'Spirit of Freedom Kennel' %>" />
        <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
        <meta name="googlebot" content="index, follow" />
        <link rel="canonical" href="https://spiritoffreedomkennel.com/blog/<%= blog.slug %>" />
        <meta name="language" content="fr" />
        <meta name="geo.region" content="FR-30" />
        <meta name="geo.placename" content="Codognan, Gard" />
        <meta property="og:type" content="article" />
        <meta property="og:site_name" content="Spirit of Freedom Kennel" />
        <meta property="og:title" content="<%= blog.titre %> | Spirit of Freedom Kennel" />
        <meta property="og:description" content="<%= blog.preview %>" />
        <meta property="og:url" content="https://spiritoffreedomkennel.com/blog/<%= blog.slug %>" />
        <%
            let socialImagePath;
            if (blogImage && blogImage.optimized_image_path) {
                socialImagePath = '/uploads/optimized/' + blogImage.optimized_image_path;
            } else if (blogImage && blogImage.image_path) {
                socialImagePath = '/uploads/' + blogImage.image_path;
            } else {
                socialImagePath = '/img/og/og-image.webp';
            }
            %>
        <meta property="og:image" content="https://spiritoffreedomkennel.com<%= socialImagePath %>" />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />
        <meta property="og:image:alt" content="<%= blogImage.balise_alt || blog.titre %>" />
        <meta property="og:locale" content="fr_FR" />
        <meta property="article:published_time" content="<%= new Date(blog.date_creation).toISOString() %>" />
        <% if (blog.date_modification) { %>
        <meta property="article:modified_time" content="<%= new Date(blog.date_modification).toISOString() %>" />
        <% } %>
        <meta property="article:author" content="<%= userInfo.kennel_name || 'Spirit of Freedom Kennel' %>" />
        <meta property="article:section" content="<%= blog.category_content || 'Blog' %>" />
        <% tags.forEach(tag => { if (tag.tag_content) { %>
        <meta property="article:tag" content="<%= tag.tag_content %>" />
        <% }}); %>
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="<%= blog.titre %> | Spirit of Freedom Kennel" />
        <meta name="twitter:description" content="<%= blog.preview %>" />
        <meta name="twitter:image" content="https://spiritoffreedomkennel.com<%= socialImagePath %>" />
        <meta name="twitter:image:alt" content="<%= blogImage.balise_alt || blog.titre %>" />
        <%- include('../front/partials/head-meta-base.ejs') %>
        <%- include('../front/partials/head-fonts-libs.ejs') %>
        <link rel="stylesheet" href="/front/css/navbar.css" />
        <link rel="stylesheet" href="/front/css/blog.css" />
        <link rel="stylesheet" href="/front/css/blog-details.css" />
    </head>
    <body class="h-100">
        <%- include('../front/frontEndAssets/header') %>
        <main style="padding-top: 70px;">
            <div class="blog-breadcrumb-mobile">
                <div class="container">
                    <div class="blog-breadcrumb">
                        <a href="/blog"><i class="fas fa-newspaper me-1"></i>Blog</a>
                        <span class="breadcrumb-sep">›</span>
                        <% if (blog.category_content) { %>
                        <a href="/blog/<%= blog.category_slug %>"><%= blog.category_content %></a>
                        <span class="breadcrumb-sep">›</span>
                        <% } %>
                        <span><%= blog.titre.length > 35 ? blog.titre.substring(0, 35) + '...' : blog.titre %></span>
                    </div>
                </div>
            </div>
            <section class="blog-detail-hero">
                <div class="container">
                    <div class="blog-detail-hero-grid">
                        <div class="blog-detail-hero-left" data-aos="fade-right">
                            <div class="blog-detail-hero-image">
                                <%
                                    let heroImageSrc;
                                    if (blogImage && blogImage.optimized_image_path) {
                                        heroImageSrc = '/uploads/optimized/' + blogImage.optimized_image_path;
                                    } else if (blogImage && blogImage.image_path) {
                                        heroImageSrc = '/uploads/' + blogImage.image_path;
                                    } else {
                                        heroImageSrc = '/img/placeholder-blog.webp';
                                    }
                                    %>
                                <img src="<%= heroImageSrc %>"
                                    alt="<%= blogImage.balise_alt || blog.titre %>"
                                    onerror="this.onerror=null; this.src='/img/placeholder-blog.webp';">
                                <% if (blog.category_content) { %>
                                <div class="blog-detail-category-badge">
                                    <i class="fas fa-tag me-1"></i><%= blog.category_content %>
                                </div>
                                <% } %>
                            </div>
                        </div>
                        <div class="blog-detail-hero-right" data-aos="fade-left">
                            <div class="blog-breadcrumb desktop-only">
                                <a href="/blog"><i class="fas fa-newspaper me-1"></i>Blog</a>
                                <span class="breadcrumb-sep">›</span>
                                <% if (blog.category_content) { %>
                                <a href="/blog/categorie/<%= blog.category_slug %>"><%= blog.category_content %></a>
                                <span class="breadcrumb-sep">›</span>
                                <% } %>
                                <span><%= blog.titre.length > 40 ? blog.titre.substring(0, 40) + '...' : blog.titre %></span>
                            </div>
                            <div class="blog-detail-title-block">
                                <div class="blog-detail-title-bar"></div>
                                <h1 class="blog-detail-title"><%= blog.titre %></h1>
                            </div>
                            <div class="blog-detail-meta">
                                <div class="blog-detail-meta-item">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span><%= new Date(blog.date_creation).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' }) %></span>
                                </div>
                                <% if (blog.date_modification) { %>
                                <div class="blog-detail-meta-sep">•</div>
                                <div class="blog-detail-meta-item">
                                    <i class="fas fa-edit"></i>
                                    <span>Modifié le <%= new Date(blog.date_modification).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' }) %></span>
                                </div>
                                <% } %>
                                <% if (blog.likes > 0) { %>
                                <div class="blog-detail-meta-sep">•</div>
                                <div class="blog-detail-meta-item">
                                    <i class="fas fa-heart"></i>
                                    <span><%= blog.likes %> j'aime</span>
                                </div>
                                <% } %>
                                <div class="blog-detail-meta-sep">•</div>
                                <div class="blog-detail-meta-item">
                                    <i class="fas fa-user"></i>
                                    <span>Spirit of Freedom Kennel</span>
                                </div>
                            </div>
                            <% if (blog.preview) { %>
                            <p class="blog-detail-preview"><%= blog.preview %></p>
                            <% } %>
                            <% if (tags && tags.some(t => t.tag_content)) { %>
                            <div class="blog-tags">
                                <% tags.forEach(tag => { if (tag.tag_content) { %>
                                <a href="/blog/tag/<%= tag.tag_slug %>" class="blog-tag">
                                <%= tag.tag_content %>
                                </a>
                                <% }}); %>
                            </div>
                            <% } %>
                            <div class="blog-detail-share">
                                <span class="blog-detail-share-label">Partager :</span>
                                <a href="https://www.facebook.com/sharer/sharer.php?u=https://spiritoffreedomkennel.com/blog/<%= blog.slug %>" 
                                    target="_blank" rel="noopener" class="blog-share-btn facebook">
                                <i class="fab fa-facebook-f"></i>
                                </a>
                                <a href="https://twitter.com/intent/tweet?url=https://spiritoffreedomkennel.com/blog/<%= blog.slug %>&text=<%= encodeURIComponent(blog.titre) %>" 
                                    target="_blank" rel="noopener" class="blog-share-btn twitter">
                                <i class="fab fa-x-twitter"></i>
                                </a>
                                <a href="https://wa.me/?text=<%= encodeURIComponent(blog.titre + ' - https://spiritoffreedomkennel.com/blog/' + blog.slug) %>" 
                                    target="_blank" rel="noopener" class="blog-share-btn whatsapp">
                                <i class="fab fa-whatsapp"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <section class="blog-detail-content-section">
                <div class="container">
                    <div class="blog-detail-content-grid">
                        <div class="blog-detail-main">
                            <% if (blogParagraphs && blogParagraphs.length > 0) { %>
                            <div class="blog-detail-paragraphs">
                                <% blogParagraphs.forEach((paragraph, index) => { %>
                                <div class="blog-detail-paragraph" data-aos="fade-up" data-aos-delay="<%= index * 50 %>">
                                    <% if (paragraph.title) { %>
                                    <h2 class="blog-paragraph-title"><%= paragraph.title %></h2>
                                    <% } %>
                                    <% if (paragraph.content) { %>
                                    <div class="blog-paragraph-content"><%- paragraph.content %></div>
                                    <% } %>
                                </div>
                                <% }); %>
                            </div>
                            <% } %>
                            <% if (suppPhotos && suppPhotos.length > 0) { %>
                            <div class="blog-detail-supp-photos" data-aos="fade-up">
                                <div class="blog-supp-photos-header">
                                    <div class="blog-supp-photos-bar"></div>
                                    <h3 class="blog-supp-photos-title">Galerie photos</h3>
                                </div>
                                <div class="blog-supp-photos-grid">
                                    <% suppPhotos.forEach((photo, index) => { %>
                                    <%
                                        let suppPhotoSrc;
                                        if (photo.optimized_image_path) {
                                            suppPhotoSrc = '/uploads/optimized/' + photo.optimized_image_path;
                                        } else {
                                            suppPhotoSrc = '/uploads/' + photo.image_path;
                                        }
                                        %>
                                    <div class="blog-supp-photo-item">
                                        <a href="<%= suppPhotoSrc %>" 
                                            data-fancybox="gallery"
                                            data-caption="<%= photo.balise_alt || '' %>">
                                            <img src="<%= suppPhotoSrc %>"
                                                alt="<%= photo.balise_alt || '' %>"
                                                onerror="this.onerror=null; this.src='/img/placeholder-blog.webp';">
                                            <div class="blog-supp-photo-overlay">
                                                <i class="fas fa-expand"></i>
                                            </div>
                                        </a>
                                        <% if (photo.balise_title) { %>
                                        <span class="blog-supp-photo-caption"><%= photo.balise_title %></span>
                                        <% } %>
                                    </div>
                                    <% }); %>
                                </div>
                            </div>
                            <% } %>
                            <% if (faqs && faqs.length > 0) { %>
                            <div class="blog-detail-faq" data-aos="fade-up">
                                <div class="blog-faq-header">
                                    <div class="blog-supp-photos-bar"></div>
                                    <h3 class="blog-supp-photos-title">Questions fréquentes</h3>
                                </div>
                                <div class="blog-faq-list">
                                    <% faqs.forEach((faq, index) => { %>
                                    <div class="blog-faq-item">
                                        <button class="blog-faq-question" data-faq="<%= index %>">
                                        <span><%= faq.question %></span>
                                        <i class="fas fa-chevron-down"></i>
                                        </button>
                                        <div class="blog-faq-answer" id="faq-<%= index %>">
                                            <div class="blog-faq-answer-inner"><%- faq.reponse %></div>
                                        </div>
                                    </div>
                                    <% }); %>
                                </div>
                            </div>
                            <% } %>
                            <% if (tags && tags.some(t => t.tag_content)) { %>
                            <div class="blog-detail-tags-footer" data-aos="fade-up">
                                <span class="blog-detail-tags-label">
                                <i class="fas fa-tags me-2"></i>Tags :
                                </span>
                                <div class="blog-tags">
                                    <% tags.forEach(tag => { if (tag.tag_content) { %>
                                    <a href="/blog/tag/<%= tag.tag_slug %>" class="blog-tag">
                                    <%= tag.tag_content %>
                                    </a>
                                    <% }}); %>
                                </div>
                            </div>
                            <% } %>
                        </div>
                        <aside class="blog-detail-sidebar">
                            <% if (recentPosts && recentPosts.length > 0) { %>
                            <div class="blog-sidebar-widget" data-aos="fade-left">
                                <div class="blog-sidebar-widget-header">
                                    <div class="blog-supp-photos-bar"></div>
                                    <h3 class="blog-sidebar-widget-title">Articles récents</h3>
                                </div>
                                <div class="blog-sidebar-posts">
                                    <% recentPosts.forEach(post => { %>
                                    <%
                                        let postImageSrc;
                                        if (post.optimized_image_path) {
                                            postImageSrc = '/uploads/optimized/' + post.optimized_image_path;
                                        } else if (post.image_path) {
                                            postImageSrc = '/uploads/' + post.image_path;
                                        } else {
                                            postImageSrc = '/img/placeholder-blog.webp';
                                        }
                                        const postDate = new Date(post.date_creation).toLocaleDateString('fr-FR', {
                                            day: 'numeric',
                                            month: 'short',
                                            year: 'numeric'
                                        });
                                        %>
                                    <a href="/blog/<%= post.slug %>" class="blog-sidebar-post">
                                        <div class="blog-sidebar-post-image">
                                            <img src="<%= postImageSrc %>"
                                                alt="<%= post.balise_alt || post.titre %>"
                                                onerror="this.onerror=null; this.src='/img/placeholder-blog.webp';">
                                        </div>
                                        <div class="blog-sidebar-post-info">
                                            <span class="blog-sidebar-post-date">
                                            <i class="fas fa-calendar-alt"></i><%= postDate %>
                                            </span>
                                            <h4 class="blog-sidebar-post-title"><%= post.titre %></h4>
                                        </div>
                                    </a>
                                    <% }); %>
                                </div>
                            </div>
                            <% } %>
                            <% if (categories && categories.length > 0) { %>
                            <div class="blog-sidebar-widget" data-aos="fade-left" data-aos-delay="100">
                                <div class="blog-sidebar-widget-header">
                                    <div class="blog-supp-photos-bar"></div>
                                    <h3 class="blog-sidebar-widget-title">Catégories</h3>
                                </div>
                                <div class="blog-sidebar-categories">
                                    <% categories.forEach(category => { %>
                                    <% if (category.count > 0) { %>
                                    <a href="/blog/categorie/<%= category.category_slug %>" class="blog-sidebar-category">
                                        <div class="blog-sidebar-category-left">
                                            <i class="fas fa-folder"></i>
                                            <span><%= category.content %></span>
                                        </div>
                                        <span class="blog-sidebar-category-count"><%= category.count %></span>
                                    </a>
                                    <% } %>
                                    <% }); %>
                                </div>
                                <a href="/blog/categories" class="blog-sidebar-see-all">
                                    <i class="fas fa-th-list me-1"></i>Voir toutes les catégories
                                </a>
                            </div>
                            <% } %>

                            <% if (randomTags && randomTags.length > 0) { %>
                            <div class="blog-sidebar-widget" data-aos="fade-left" data-aos-delay="150">
                                <div class="blog-sidebar-widget-header">
                                    <div class="blog-supp-photos-bar"></div>
                                    <h3 class="blog-sidebar-widget-title">Tags populaires</h3>
                                </div>
                                <div class="blog-tags">
                                    <% randomTags.forEach(tag => { %>
                                    <a href="/blog/tag/<%= tag.tag_slug %>" class="blog-tag">
                                        <%= tag.content %>
                                    </a>
                                    <% }); %>
                                </div>
                                <a href="/blog/tags" class="blog-sidebar-see-all">
                                    <i class="fas fa-tags me-1"></i>Voir tous les tags
                                </a>
                            </div>
                            <% } %>
                            <div class="blog-sidebar-widget blog-sidebar-cta" data-aos="fade-left" data-aos-delay="200">
                                <div class="blog-sidebar-cta-icon">
                                    <i class="fas fa-paw"></i>
                                </div>
                                <h3 class="blog-sidebar-cta-title">Un chiot vous intéresse ?</h3>
                                <p class="blog-sidebar-cta-text">Contactez-nous pour en savoir plus sur nos chiots disponibles et nos prochaines portées.</p>
                                <a href="/contact" class="btn-blog-cta">
                                <i class="fas fa-envelope me-2"></i>Nous contacter
                                </a>
                                <a href="/chiots" class="btn-blog-cta-secondary">
                                <i class="fas fa-paw me-2"></i>Voir les chiots
                                </a>
                            </div>
                        </aside>
                    </div>
                </div>
            </section>
        </main>
        <%- include('../front/frontEndAssets/footer') %>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="/front/js/header.js"></script>
        <%- include('./partials/googleAnalytics') %>
        <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
        <script>
            AOS.init({
                duration: 1000,
                easing: "ease-in-out",
                once: true,
                offset: 120,
                delay: 0,
                anchorPlacement: "top-bottom",
                mirror: false,
                disable: "mobile",
            });
        </script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const faqItems = document.querySelectorAll(".blog-faq-item");
            
                faqItems.forEach((item, index) => {
                    const question = item.querySelector(".blog-faq-question");
                    const answer = document.getElementById("faq-" + index);
            
                    if (question && answer) {
                        question.addEventListener("click", function () {
                            const isOpen = item.classList.contains("active");
            
                            faqItems.forEach(otherItem => {
                                const otherIndex = [...faqItems].indexOf(otherItem);
                                const otherAnswer = document.getElementById("faq-" + otherIndex);
                                otherItem.classList.remove("active");
                                if (otherAnswer) otherAnswer.classList.remove("open");
                            });
            
                            if (!isOpen) {
                                item.classList.add("active");
                                answer.classList.add("open");
                            }
                        });
                    }
                });
            });
        </script>
    </body>
</html>